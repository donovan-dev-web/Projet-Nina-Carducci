export function initGallery(modal){const grid=document.querySelector(".gallery-grid");const filterContainer=document.querySelector(".gallery-filter");const items=Array.from(grid.querySelectorAll(".gallery-item"));let activeFilter="all";let visibleIndexes=[];init();function init(){generateFilters();applyFilter("all");items.forEach((item,index)=>{item.addEventListener("click",()=>{if(modal){const visibleImages=visibleIndexes.map(i=>({src:items[i].src,alt:items[i].alt,}));const startIndex=visibleIndexes.indexOf(index);modal.openModal(visibleImages,startIndex)}else{console.log("Image cliquÃ©e :",{index,visibleIndexes,})}})})}
function generateFilters(){const tags=new Set(items.map(img=>img.dataset.galleryTag));const allButton=filterContainer.querySelector('[data-gallery-filter="all"]');allButton.classList.add("active");allButton.addEventListener("click",()=>applyFilter("all"));tags.forEach(tag=>{const btn=document.createElement("button");btn.textContent=tag;btn.dataset.galleryFilter=tag;btn.addEventListener("click",()=>applyFilter(tag));filterContainer.appendChild(btn)})}
function applyFilter(tag){activeFilter=tag;visibleIndexes=[];items.forEach((item,index)=>{const isVisible=tag==="all"||item.dataset.galleryTag===tag;item.classList.toggle("hidden",!isVisible);if(isVisible)visibleIndexes.push(index);});updateActiveButton(tag)}
function updateActiveButton(tag){filterContainer.querySelectorAll("button").forEach(btn=>btn.classList.remove("active"));const activeBtn=filterContainer.querySelector(`[data-gallery-filter="${tag}"]`);if(activeBtn)activeBtn.classList.add("active");}
return{getVisibleIndexes:()=>[...visibleIndexes],getActiveFilter:()=>activeFilter,}}